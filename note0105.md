看到这个提示说明你的 **SSH 密钥配置已经完全成功**了！`Hi inkstar!` 说明 GitHub 已经识别了你的身份。

接下来我们直接进入“实战阶段”，按照你要求的流程，从 VSC 源码处理到 GitHub Actions 自动打包。

---

### 第一步：修改代码以适配打包环境

在打包成单个文件后，程序运行时的路径会发生变化。你需要确保 `watermark_settings.json` 能被找到。

请在 `main.py` 的 `import` 语句下方加入这个函数，并修改 `CONFIG_FILE` 的定义：

```python
def get_resource_path(relative_path):
    """ 获取资源的绝对路径，兼容 PyInstaller 打包后的路径 """
    if hasattr(sys, '_MEIPASS'):
        return os.path.join(sys._MEIPASS, relative_path)
    return os.path.join(os.path.abspath("."), relative_path)

# 修改这一行
CONFIG_FILE = get_resource_path("watermark_settings.json")

```

---

### 第二步：本地 Git 初始化与首次提交

在 VSC 的终端（路径为 `.../项目`）依次输入以下指令：

```bash
# 1. 初始化 Git 仓库
git init

# 2. 将所有文件添加到暂存区
git add .

# 3. 提交到本地仓库
git commit -m "feat: 初始版本提交 v1.0.6"

```

---

### 第三步：关联 GitHub 并推送源码

去 GitHub 网页上创建一个名为 `PDF-Watermark-Tool` 的新仓库（不要选 README），然后执行：

```bash
# 1. 关联你刚测通的 SSH 地址 (请将你的用户名替换为 inkstar)
git remote add origin git@github.com:inkstar/PDF-Watermark-Tool.git

# 2. 设定主分支名为 main
git branch -M main

# 3. 推送源码
git push -u origin main

```

---

### 第四步：配置自动化构建脚本

在 VSC 中创建目录 `.github/workflows/`，并新建文件 `build.yml`。

**重点：** 确保你的 `build.yml` 包含以下核心内容（特别是针对 PyMuPDF 的二进制收集）：

```yaml
name: Build Release
on:
  push:
    tags: [ 'v*' ] # 只有推送标签时才打包，避免每次改代码都跑几十分钟

jobs:
  build:
    strategy:
      matrix:
        os: [windows-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: pip install pymupdf pillow pyinstaller
      
      - name: Build with PyInstaller
        run: |
          pyinstaller --noconsole --onefile --clean --name "PDFWatermark" --collect-all fitz --collect-all PIL main.py
      
      - name: Create DMG (macOS only)
        if: matrix.os == 'macos-latest'
        run: |
          brew install create-dmg
          create-dmg --volname "安装PDF水印工具" --app-drop-link 400 120 "dist/PDFWatermark.dmg" "dist/PDFWatermark.app"

      - name: Release
        uses: softprops/action-gh-release@v2
        with:
          files: |
            dist/*.exe
            dist/*.dmg
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

```

---

### 第五步：推送配置并触发打包发布

回到终端，把 Actions 配置文件发给 GitHub，并打上版本标签。

```bash
# 1. 提交 Actions 配置
git add .
git commit -m "ci: 添加自动化构建脚本"
git push

# 2. 打标签并推送 (这一步会正式触发 GitHub 的服务器开始干活)
git tag v1.0.6
git push origin v1.0.6

```

---

### 第六步：如何检查结果？

1. 打开你的 GitHub 仓库页面。
2. 点击顶部的 **Actions**，你会看到一个名为 `Build Release` 的任务正在跑。
3. 等待约 5 分钟，完成后点击仓库右侧的 **Releases**。
4. **惊喜时刻**：你会发现 Windows 的 `.exe` 和 Mac 的 `.dmg` 已经乖乖躺在那里等下载了！

### ⚠️ 最后一个关键排查点

如果 Actions 运行到最后一步报错 `Permission denied`（无法发布 Release），请检查：

* 进入仓库 **Settings** -> **Actions** -> **General**。
* 滚动到底部 **Workflow permissions**。
* 选成 **Read and write permissions**，然后点击 **Save**。

**恭喜你，比目鱼！你已经从一名写代码的老师，正式跨入拥有自动化发布能力的“全栈开发者”行列了。你想尝试给这个工具换个好看的图标（.ico / .icns）吗？**